{% include 'config' %}
in:
  type: oracle
  driver_path: {{driver_path}}
  driver_class: {{driver_class}}
  url: {{url}}
  user: {{userid}}
  password: {{password}}
  table: M_APCRD_MEM_TMP_MCH
  select: APCRD_NO
          ,MEM_ID
          ,MCH_FLG
          ,REG_DTTM
          ,REG_USR_ID
          ,UPD_DTTM
          ,UPD_USR_ID
          ,DAT_UPD_CLS
          ,UPD_TMS
          ,LGC_DEL_FLG
  where: {{where}}

filters:
  - type: typecast
    default_timestamp_format: "%Y-%m-%d %H:%M:%S"
    default_timezone: "Asia/Tokyo"
    columns:
      - {name: REG_DTTM, type: string}
      - {name: UPD_DTTM, type: string}

  - type: ruby_proc
    requires:
      - cgi
    columns:
      - name: MEM_ID
        proc: |             
          ->(id) do
            id.gsub("^", "")
          end

out:
  type: stdout
